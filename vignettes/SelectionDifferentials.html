<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sandy Kawano" />

<meta name="date" content="2016-05-25" />

<title>Estimating phenotypic selection differentials</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Estimating phenotypic selection differentials</h1>
<h4 class="author"><em>Sandy Kawano</em></h4>
<h4 class="date"><em>2016-05-25</em></h4>



<div id="install-psa-from-github" class="section level3">
<h3>Install psa from GitHub</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(devtools)</code></pre></div>
<pre><code>## Loading required package: devtools</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install_github(&quot;MorphoFun/psa&quot;, build_vignettes = TRUE)</span>
<span class="kw">library</span>(psa)</code></pre></div>
<p>To see all of the vignettes that are available in <code>psa</code>, type <code>browseVignettes(&quot;psa&quot;)</code>.</p>
</div>
<div id="loading-the-male-bumpus-data-as-an-example" class="section level3">
<h3>Loading the Male Bumpus data as an example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(BumpusMales)</code></pre></div>
</div>
<div id="check-the-structure-of-the-data" class="section level3">
<h3>Check the structure of the data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(BumpusMales)</code></pre></div>
<pre><code>## 'data.frame':    87 obs. of  13 variables:
##  $ w             : num  1.71 1.71 1.71 1.71 1.71 ...
##  $ W             : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ TotalLength_mm: int  154 160 155 154 156 161 157 159 158 158 ...
##  $ AlarExtent_mm : int  241 252 243 245 247 253 251 247 247 252 ...
##  $ Weight_g      : num  24.5 26.9 26.9 24.3 24.1 26.5 24.6 24.2 23.6 26.2 ...
##  $ SkullL_mm     : num  31.2 30.8 30.6 31.7 31.5 31.8 31.1 31.4 29.8 32 ...
##  $ HumerusL_mm   : num  17.4 18.7 18.6 18.8 18.2 ...
##  $ FemurL_mm     : num  17 18 17.9 17.5 17.9 ...
##  $ TibioTarL_mm  : num  26 30 29.2 29.1 28.7 ...
##  $ SkullW_mm     : num  14.9 15.3 15.3 14.8 14.6 ...
##  $ SternumL_mm   : num  21.1 21.4 21.5 21.3 20.9 ...
##  $ Sex           : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ AgeGroup      : int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="check-the-documentation-to-understand-what-each-of-the-13-columns-represent" class="section level3">
<h3>Check the documentation to understand what each of the 13 columns represent</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?BumpusMales</code></pre></div>
</div>
<div id="define-the-parameters" class="section level3">
<h3>Define the parameters</h3>
<div id="fitness-will-be-represented-by-the-relative-fitness-w-which-is-the-absolute-fitness-w-of-an-individual-divided-by-the-mean-absolute-fitness-for-the-group." class="section level4">
<h4>Fitness will be represented by the relative fitness (w), which is the absolute fitness (W) of an individual divided by the mean absolute fitness for the group.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span>BumpusMales[,<span class="dv">1</span>]</code></pre></div>
</div>
<div id="the-phenotypic-traits-are-stored-under-z" class="section level4">
<h4>The phenotypic traits are stored under z:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span>BumpusMales[,<span class="dv">3</span>:<span class="dv">11</span>]</code></pre></div>
</div>
<div id="since-weight-is-a-volume-and-the-other-traits-are-linear-measurements-we-need-to-adjust-for-the-dimensionality-differences-by-taking-the-cube-root-of-weight_g.-alternatively-one-could-cube-all-of-the-other-phenotypic-traits-except-weight_g" class="section level4">
<h4>Since Weight is a volume, and the other traits are linear measurements, we need to adjust for the dimensionality differences by taking the cube root of Weight_g. (Alternatively, one could cube all of the other phenotypic traits except Weight_g)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z$Weight_g &lt;-<span class="st"> </span>z$Weight_g^(<span class="dv">1</span>/<span class="dv">3</span>)</code></pre></div>
</div>
</div>
<div id="estimate-phenotypic-selection-differentials" class="section level3">
<h3>Estimate phenotypic selection differentials</h3>
<p><em>Overview of estimating selection differentials</em></p>
<table style="width:126%;">
<colgroup>
<col width="69%"></col>
<col width="56%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">linear selection differential (<span class="math inline">\(S_i\)</span>)</td>
<td align="left">cov(w, <span class="math inline">\(\bar{z}\)</span>)</td>
</tr>
<tr class="even">
<td align="left">quadratic selection differential (<span class="math inline">\(C_{i,i}\)</span>)</td>
<td align="left">cov(w, (z - <span class="math inline">\(\bar{z})^2\)</span>)</td>
</tr>
<tr class="odd">
<td align="left">correlational selection differential (<span class="math inline">\(C_{i,j}\)</span>)</td>
<td align="left">cov(w, (zi - <span class="math inline">\(\bar{z_i})(z_j - \bar{z_j}\)</span>))</td>
</tr>
</tbody>
</table>
<p>See Brodie et al. 1995 for a more detailed description.</p>
<div id="calculate-the-selection-differentials-using-psadcov" class="section level4">
<h4>Calculate the selection differentials using psa::dCov()</h4>
<p>The phenotypic traits (z) will automatically be centered to a mean of zero and scaled to unit variance, as part of the dCov function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">dCov</span>(w, z)
d</code></pre></div>
<pre><code>##                 TotalLength_mm                  AlarExtent_mm 
##                  -0.3694482090                  -0.0135955629 
##                       Weight_g                      SkullL_mm 
##                  -0.2331200346                   0.0897961209 
##                    HumerusL_mm                      FemurL_mm 
##                   0.1597756323                   0.1330311154 
##                   TibioTarL_mm                      SkullW_mm 
##                   0.0942776554                   0.0643777446 
##                    SternumL_mm              TotalLength_mm.Sq 
##                   0.1283547160                  -0.0699714012 
##               AlarExtent_mm.Sq                    Weight_g.Sq 
##                  -0.1210564442                  -0.1432745016 
##                   SkullL_mm.Sq                 HumerusL_mm.Sq 
##                   0.0457080018                  -0.1589423546 
##                   FemurL_mm.Sq                TibioTarL_mm.Sq 
##                   0.0396038069                   0.0798331318 
##                   SkullW_mm.Sq                 SternumL_mm.Sq 
##                  -0.0306501428                   0.0766266718 
## TotalLength_mm x AlarExtent_mm      TotalLength_mm x Weight_g 
##                  -0.0999261522                  -0.1294037151 
##     TotalLength_mm x SkullL_mm   TotalLength_mm x HumerusL_mm 
##                  -0.0375010875                  -0.0445455548 
##     TotalLength_mm x FemurL_mm  TotalLength_mm x TibioTarL_mm 
##                   0.0406014191                   0.0378711647 
##     TotalLength_mm x SkullW_mm   TotalLength_mm x SternumL_mm 
##                  -0.0141093410                  -0.0837775068 
##       AlarExtent_mm x Weight_g      AlarExtent_mm x SkullL_mm 
##                  -0.0948211068                  -0.0863978920 
##    AlarExtent_mm x HumerusL_mm      AlarExtent_mm x FemurL_mm 
##                  -0.1200671922                  -0.0421876994 
##   AlarExtent_mm x TibioTarL_mm      AlarExtent_mm x SkullW_mm 
##                   0.0033359164                  -0.1046106426 
##    AlarExtent_mm x SternumL_mm           Weight_g x SkullL_mm 
##                  -0.1111411025                   0.0247076528 
##         Weight_g x HumerusL_mm           Weight_g x FemurL_mm 
##                  -0.0385964842                   0.0255648479 
##        Weight_g x TibioTarL_mm           Weight_g x SkullW_mm 
##                   0.0690923551                   0.0068857851 
##         Weight_g x SternumL_mm        SkullL_mm x HumerusL_mm 
##                  -0.0658829780                  -0.0006822628 
##          SkullL_mm x FemurL_mm       SkullL_mm x TibioTarL_mm 
##                   0.0538580632                  -0.0198914274 
##          SkullL_mm x SkullW_mm        SkullL_mm x SternumL_mm 
##                  -0.0896968356                  -0.0088108980 
##        HumerusL_mm x FemurL_mm     HumerusL_mm x TibioTarL_mm 
##                  -0.0809513831                  -0.0141827303 
##        HumerusL_mm x SkullW_mm      HumerusL_mm x SternumL_mm 
##                  -0.0337689238                  -0.0719031155 
##       FemurL_mm x TibioTarL_mm          FemurL_mm x SkullW_mm 
##                   0.0445949188                   0.0167577482 
##        FemurL_mm x SternumL_mm       TibioTarL_mm x SkullW_mm 
##                   0.0009356880                  -0.0381630398 
##     TibioTarL_mm x SternumL_mm        SkullW_mm x SternumL_mm 
##                   0.0346606920                  -0.0269561657</code></pre>
<p>dCov outputs the linear and nonlinear selection differentials. The terms ending in “.Sq” are the quadratic selection differentials, and the interactions are the correlational selection differentials.</p>
</div>
<div id="are-all-methods-to-estimate-selection-differentials-equivalent" class="section level4">
<h4>Are all methods to estimate selection differentials equivalent?</h4>
<p>The short answer is: no. To illustrate this, we can use the psa::dCompare function to compare how different methods to quantify selection differentials impact the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Look up the documentation for dCompare</span>
?dCompare

<span class="kw">round</span>(<span class="kw">dCompare</span>(w, z), <span class="dv">3</span>)</code></pre></div>
<pre><code>##             TotalLength_mm AlarExtent_mm Weight_g SkullL_mm HumerusL_mm
## dCov                -1.184        -0.060   -0.013     0.058       0.094
## dMean               -1.170        -0.059   -0.012     0.057       0.093
## dReg                -0.115        -0.003   -4.336     0.139       0.270
## dMean_stdsd         -0.007         0.000   -0.004     0.002       0.005
## dCovScale           -0.369        -0.014   -0.233     0.090       0.160
## dMeanScale           0.000         0.000    0.000     0.000       0.000
## dRegScale           -0.369        -0.014   -0.233     0.090       0.160
##             FemurL_mm TibioTarL_mm SkullW_mm SternumL_mm TotalLength_mm.Sq
## dCov            0.080        0.098     0.024       0.116            -0.719
## dMean           0.079        0.097     0.023       0.115            -0.667
## dReg            0.221        0.091     0.176       0.142            -0.005
## dMean_stdsd     0.004        0.003     0.002       0.005            -0.198
## dCovScale       0.133        0.094     0.064       0.128            -0.070
## dMeanScale      0.000        0.000     0.000       0.000             0.000
## dRegScale       0.133        0.094     0.064       0.128            -0.052
##             AlarExtent_mm.Sq Weight_g.Sq SkullL_mm.Sq HumerusL_mm.Sq
## dCov                  -2.373       0.000        0.019         -0.056
## dMean                 -2.230       0.000        0.023         -0.053
## dReg                  -0.004      -6.025        0.147         -0.056
## dMean_stdsd           -0.114      -0.190        0.046         -0.177
## dCovScale             -0.121      -0.143        0.046         -0.159
## dMeanScale             0.000       0.000        0.000          0.000
## dRegScale             -0.077      -0.017        0.061         -0.019
##             FemurL_mm.Sq TibioTarL_mm.Sq SkullW_mm.Sq SternumL_mm.Sq
## dCov               0.014           0.086       -0.004          0.063
## dMean              0.017           0.096       -0.003          0.070
## dReg               0.150           0.053       -0.110          0.065
## dMean_stdsd        0.031           0.080       -0.027          0.069
## dCovScale          0.040           0.080       -0.031          0.077
## dMeanScale         0.000           0.000        0.000          0.000
## dRegScale          0.055           0.057       -0.015          0.053
##             TotalLength_mm x AlarExtent_mm TotalLength_mm x Weight_g
## dCov                                -1.418                    -0.022
## dMean                               -1.358                    -0.022
## dReg                                -0.005                    -0.346
## dMean_stdsd                         -0.162                    -0.403
## dCovScale                           -0.088                    -0.119
## dMeanScale                          -0.003                    -0.136
## dRegScale                           -0.067                    -0.060
##             TotalLength_mm x SkullL_mm TotalLength_mm x HumerusL_mm
## dCov                            -0.078                       -0.084
## dMean                           -0.072                       -0.077
## dReg                             0.015                       -0.010
## dMean_stdsd                     -0.008                        0.043
## dCovScale                       -0.038                       -0.039
## dMeanScale                       0.025                        0.113
## dRegScale                        0.031                       -0.018
##             TotalLength_mm x FemurL_mm TotalLength_mm x TibioTarL_mm
## dCov                             0.078                         0.126
## dMean                            0.088                         0.140
## dReg                            -0.005                         0.011
## dMean_stdsd                      0.212                         0.201
## dCovScale                        0.033                         0.029
## dMeanScale                       0.147                         0.110
## dRegScale                       -0.009                         0.038
##             TotalLength_mm x SkullW_mm TotalLength_mm x SternumL_mm
## dCov                            -0.017                       -0.243
## dMean                           -0.012                       -0.234
## dReg                            -0.037                       -0.011
## dMean_stdsd                      0.033                       -0.112
## dCovScale                       -0.014                       -0.091
## dMeanScale                       0.065                       -0.013
## dRegScale                       -0.043                       -0.033
##             AlarExtent_mm x Weight_g AlarExtent_mm x SkullL_mm
## dCov                          -0.023                    -0.247
## dMean                         -0.022                    -0.240
## dReg                          -0.135                    -0.020
## dMean_stdsd                   -0.189                    -0.218
## dCovScale                     -0.085                    -0.072
## dMeanScale                    -0.021                    -0.071
## dRegScale                     -0.032                    -0.058
##             AlarExtent_mm x HumerusL_mm AlarExtent_mm x FemurL_mm
## dCov                             -0.314                    -0.113
## dMean                            -0.301                    -0.098
## dReg                             -0.011                    -0.009
## dMean_stdsd                      -0.153                    -0.049
## dCovScale                        -0.090                    -0.033
## dMeanScale                       -0.005                    -0.004
## dRegScale                        -0.029                    -0.023
##             AlarExtent_mm x TibioTarL_mm AlarExtent_mm x SkullW_mm
## dCov                               0.015                    -0.169
## dMean                              0.040                    -0.165
## dReg                               0.006                    -0.048
## dMean_stdsd                        0.016                    -0.235
## dCovScale                          0.002                    -0.086
## dMeanScale                         0.024                    -0.076
## dRegScale                          0.027                    -0.078
##             AlarExtent_mm x SternumL_mm Weight_g x SkullL_mm
## dCov                             -0.445                0.001
## dMean                            -0.433                0.001
## dReg                             -0.017                1.448
## dMean_stdsd                      -0.232                0.118
## dCovScale                        -0.099                0.023
## dMeanScale                       -0.097                0.090
## dRegScale                        -0.069                0.050
##             Weight_g x HumerusL_mm Weight_g x FemurL_mm
## dCov                        -0.001                0.001
## dMean                       -0.001                0.001
## dReg                         2.207                3.009
## dMean_stdsd                  0.005                0.136
## dCovScale                   -0.037                0.023
## dMeanScale                   0.113                0.108
## dRegScale                    0.070                0.098
##             Weight_g x TibioTarL_mm Weight_g x SkullW_mm
## dCov                          0.004                0.000
## dMean                         0.004                0.000
## dReg                          2.370                0.338
## dMean_stdsd                   0.201                0.068
## dCovScale                     0.058                0.007
## dMeanScale                    0.135                0.074
## dRegScale                     0.132                0.007
##             Weight_g x SternumL_mm SkullL_mm x HumerusL_mm
## dCov                        -0.003                   0.000
## dMean                       -0.003                   0.001
## dReg                         0.458                   0.213
## dMean_stdsd                 -0.083                  -0.020
## dCovScale                   -0.062                  -0.001
## dMeanScale                  -0.006                   0.029
## dRegScale                    0.022                   0.081
##             SkullL_mm x FemurL_mm SkullL_mm x TibioTarL_mm
## dCov                        0.021                   -0.013
## dMean                       0.023                   -0.011
## dReg                        0.261                    0.050
## dMean_stdsd                 0.088                   -0.046
## dCovScale                   0.046                   -0.016
## dMeanScale                  0.025                   -0.054
## dRegScale                   0.102                    0.034
##             SkullL_mm x SkullW_mm SkullL_mm x SternumL_mm
## dCov                       -0.021                  -0.005
## dMean                      -0.021                  -0.003
## dReg                       -0.195                   0.067
## dMean_stdsd                -0.226                  -0.037
## dCovScale                  -0.077                  -0.010
## dMeanScale                 -0.096                  -0.040
## dRegScale                  -0.046                   0.039
##             HumerusL_mm x FemurL_mm HumerusL_mm x TibioTarL_mm
## dCov                         -0.029                     -0.009
## dMean                        -0.027                     -0.005
## dReg                          0.034                      0.070
## dMean_stdsd                  -0.109                     -0.030
## dCovScale                    -0.059                     -0.010
## dMeanScale                   -0.028                      0.022
## dRegScale                     0.012                      0.043
##             HumerusL_mm x SkullW_mm HumerusL_mm x SternumL_mm
## dCov                         -0.007                    -0.038
## dMean                        -0.007                    -0.037
## dReg                          0.081                    -0.011
## dMean_stdsd                  -0.085                    -0.180
## dCovScale                    -0.027                    -0.065
## dMeanScale                    0.011                    -0.062
## dRegScale                     0.018                    -0.006
##             FemurL_mm x TibioTarL_mm FemurL_mm x SkullW_mm
## dCov                           0.028                 0.004
## dMean                          0.032                 0.004
## dReg                           0.091                 0.188
## dMean_stdsd                    0.049                 0.027
## dCovScale                      0.030                 0.015
## dMeanScale                    -0.005                 0.011
## dRegScale                      0.057                 0.041
##             FemurL_mm x SternumL_mm TibioTarL_mm x SkullW_mm
## dCov                          0.001                   -0.014
## dMean                         0.002                   -0.013
## dReg                          0.049                   -0.012
## dMean_stdsd                  -0.026                   -0.106
## dCovScale                     0.001                   -0.034
## dMeanScale                   -0.034                   -0.050
## dRegScale                     0.027                   -0.005
##             TibioTarL_mm x SternumL_mm SkullW_mm x SternumL_mm
## dCov                             0.033                  -0.009
## dMean                            0.036                  -0.008
## dReg                             0.072                  -0.108
## dMean_stdsd                      0.062                  -0.129
## dCovScale                        0.032                  -0.030
## dMeanScale                      -0.005                  -0.038
## dRegScale                        0.068                  -0.035</code></pre>
<p>First, scaling the data to a mean of zero and unit variance makes a big difference. When reporting selection coefficients, it is recommended to report the <em>standardized</em> selection coefficients so that they are more comparable across studies.</p>
<p>Next, let’s focus on dCovScale vs dRegScale. The dCovScale row provides the same results as the psa::dCov function. dRegScale represents a linear regression with the minimum number of traits for the analysis. Linear selection differentals using dRegScale would be estimated by <span class="math inline">\(w = \alpha + z_i\)</span>, quadratic selection differents by <span class="math inline">\(w = \alpha + z_i + 0.5z_i^2\)</span>, and correlational selection differentials by <span class="math inline">\(w = \alpha + z_i + z_j + z_iz_j\)</span>, whereby the z data would be normalized to a mean of zero and unit variance. Notice that the differentials produced by dCovScale and dRegScale are the same for only linear selection. The regression-based method does not produce similar results to the covariance method once nonlinear selection differentials are estimated. The estimates from using these two methods on the exact same data set can be orders of magnitude different. For instance, “TotalLength_mm x FemurL_mm” has 0.033 vs -0.009 for dCovScale and dRegScale, respectively, which alters the interpretation from an increase in covariance to a decrease in covariance. Moreover, “Weight_g x TibioTarL_mm” has 0.058 vs. 0.132, which is the difference between weak selection and strong selection. Yet, on other ocassions, dRegScale and dCovScale still produce comparable results for nonlinear terms: “Weight_g x SkullW_mm” is estimated to be 0.007 for both methods.</p>
<p><strong>References</strong><br />
Brodie ED III, Moore AJ, Janzen FJ. 1995. Visualizing and quantifying natural selection. <em>TREE</em> 10(8): 313-318.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
